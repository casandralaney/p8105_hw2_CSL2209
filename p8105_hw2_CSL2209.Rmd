---
title: "p8105_hw2_CSL2209"
author: "Casandra Laney"
date: "2025-10-01"
output: github_document
---

```{r}
library(tidyverse)
library(readxl)
library(haven)
```


## Problem 1
clean the data in pols-month.csv

```{r}
pols_month_df = read.csv("data/pols-month.csv") |>
  janitor::clean_names() |>
  separate(mon, into = c("year", "month", "day"), sep = '-'
  ) |>
  mutate(
    month =
      case_match(
        month,
        "01" ~ "jan",
        "02" ~ "feb",
        "03" ~ "mar",
        "04" ~ "apr",
        "05" ~ "may",
        "06" ~ "jun",
        "07" ~ "jul",
        "08" ~ "aug",
        "09" ~ "sept",
        "10" ~ "oct",
        "11" ~ "nov",
        "12" ~ "dec"),
    month = as.factor(month),
    year = as.integer(year),
    day = as.integer(day),
    president = 
      case_match (
        prez_gop,
        1 ~ "gop",
        0 ~ "dem")) |>
  select(-day, -prez_dem, -prez_gop)
```

clean the data in snp.csv

```{r}
snp_df = read.csv("data/snp.csv") |>
  janitor::clean_names() |>
  separate(date, into = c("month", "day", "year"), sep = '/') |>
  mutate(
    month =
      case_match(
        month,
        "1" ~ "jan",
        "2" ~ "feb",
        "3" ~ "mar",
        "4" ~ "apr",
        "5" ~ "may",
        "6" ~ "jun",
        "7" ~ "jul",
        "8" ~ "aug",
        "9" ~ "sept",
        "10" ~ "oct",
        "11" ~ "nov",
        "12" ~ "dec"),
    month = as.factor(month),
    year = as.integer(year),
    day = as.integer(day),
    year = ifelse(year < 50, year + 2000, year + 1900)
  ) |>
  select(year, month, close, -day) 
```

tidy the unemployment data 

```{r}
unemployment_df = read.csv("data/unemployment.csv") |>
  janitor::clean_names() |>
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemployment")
```

Join the datasets

```{r}
pols_snp = left_join(pols_month_df, snp_df, by = c("year", "month"))

five_thirty_eight = left_join(pols_snp, unemployment_df, by = c("year", "month"))
```


About these datasets

The dataset 'five_thirty_eight' consists of pols_month_df, snp_df, and unemployment_df. Pols_df contains information related to the number of national politicians who are democratic or republican. snp_df contains information related to Standard and Poor's stock market index. unemployment_df contains the percentage of unemployment in the respective year and month.The 'five_thirty_eight'dataset consists of 822 observations and 11 variables. Some important variables include:

- year: year of count

- month: month of count

- president: political party of president at the time

- close: the closing values of S&P stock index

- unemployment: unemployment percentage of respective year/month.

## Problem 2

Read and clean the Mr. Trash, Professor, and Gwynnda sheets

```{r}
mr_trash_wheel = 
  read_excel("data/202509 Trash Wheel Collection Data.xlsx", sheet = "Mr. Trash Wheel", skip = 1) |>
  janitor::clean_names() |>
  select(-x15, -x16) |>
  drop_na(dumpster) |>
  mutate(
    month = as.factor(month),
    year = as.integer(year),
    sports_balls = as.integer(sports_balls),
    wheel = "mr_trash") 

professor_trash_wheel = 
  read_excel("data/202509 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel", skip = 1) |>
  janitor::clean_names() |>
  drop_na(dumpster) |>
  mutate(
    month = as.factor(month),
    year = as.integer(year),
    wheel = "professor"
  )
  
gwynnda = 
  read_excel("data/202509 Trash Wheel Collection Data.xlsx", sheet = "Gwynns Falls Trash Wheel", skip = 1) |>
  janitor::clean_names() |>
  drop_na(dumpster) |>
  mutate(
    month = as.factor(month),
    year = as.integer(year),
    wheel = "gwynnda"
  )

```

Combine the three datasets into one

```{r}
tidy_wheels = 
  bind_rows(mr_trash_wheel, professor_trash_wheel, gwynnda) |>
  janitor::clean_names()
```


The dataset tidy_wheels consists of 1188 observations and 15 variables. Key variables include:

- dumpster: which dumpster the trash was collected from

- wheel: which wheel the trash was collected from

- year: year trash was collected

- month: month trash was collected

- weight_tons: weight of total trash in tons

The total weight of trash collected by Professor Trash Wheel was `r sum (professor_trash_wheel$weight_tons)` tons. The total number of cigarette butts collected by Gwynnda in June of 2022 was `r sum(filter(gwynnda, month == "June", year == "2022")$cigarette_butts)` cigarette butts.

## Problem 3

Import, clean, and tidy

```{r}
zori = read_csv("data/zillow_data/Zip_zori_uc_sfrcondomfr_sm_month_NYC.csv") |>
  janitor::clean_names() |>
  drop_na() |>
  pivot_longer(
    x2015_01_31:x2024_08_31,
    names_to = "date", 
    values_to = "zori"
    ) |>
    mutate(
      date = str_remove(date, "^x"),
      zip_code = as.factor(region_name)) |>
  select(-region_name, -region_type, -state, -city, -state_name, -county_name, -metro)
  

zip_codes = read_csv("data/zillow_data/Zip Codes.csv") |>
  janitor::clean_names() |>
  mutate(
    zip_code = as.factor(zip_code),
    neighborhood = as.factor(neighborhood),
    ) |>
  select(-file_date)

tidy_zillow =
  zori |>
  left_join(zip_codes, by = "zip_code") |>
  select(date, zip_code, neighborhood, county, zori, state_fips, county_code, county_fips, region_id, size_rank)

skimr::skim(tidy_zillow)
```

The 'tidy_zillow' dataset shows the neighborhood, zip code, and ZORI at a given date in NYC. the ZORI is the Zillow Observed Rent Index, which is a measure of the market rate rent across a region.

Some important variables include:

- date: date of observation

- zip code: zip code of area of focus

- neighborhood: neighborhood of area of focus

- county: county of area of focus

- zori: the ZORI of area of focus.

The tidy_zillow dataset consists of 5684 observations and 10 variables. There are a total of 48 unique ZIP codes and 19 unique neighborhoods. 
